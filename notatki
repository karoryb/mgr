Wprowadzenie i Cel Badawczy

Analiza filogenetyczna, kluczowa dla określenia pozycji ewolucyjnej organizmów, tradycyjnie opiera się na porównywaniu sekwencji DNA, z czego mitochondrialne DNA (mtDNA) jest szczególnie przydatne ze względu na swoją konserwatywność i stosunkowo niewielką długość. Klasyczne metody często dostarczają jedynie probabilistycznych wyników klasyfikacji, pozostawiając brak wyjaśnienia przyczyn stojących za daną decyzją taksonomiczną.
Celem niniejszego projektu jest zbudowanie interpretowalnego systemu klasyfikacji organizmów na podstawie sekwencji mtDNA, który nie tylko osiągnie wysoką dokładność klasyfikacyjną, ale również dostarczy biologicznie uzasadnionych wyjaśnień decyzji algorytmu. Stanowi to odpowiedź na rosnącą potrzebę zwiększenia zaufania do systemów uczenia maszynowego w bioinformatyce.

Metodyka Realizacji i Dotychczasowy Postęp
Dotychczasowa praca koncentrowała się na pozyskaniu i wstępnym przetworzeniu danych wejściowych, stanowiących fundament dla późniejszego modelowania za pomocą głębokich sieci neuronowych.

1. Pozyskanie Danych i Etykietowanie
Dane wejściowe stanowią pełne sekwencje mitochondrialnego DNA (mtDNA) pochodzące z bazy danych National Center for Biotechnology Information (NCBI). Sekwencje te zostały pobrane dla zdefiniowanego zestawu organizmów, reprezentujących kluczowe, ewolucyjnie odległe grupy taksonomiczne (Kotowate, Naczelne, Gryzonie, Walenie, Słoniowate, Psowate, Torbacze i Mroczkowate).
Krytycznym elementem wstępnej fazy było dokładne etykietowanie każdej sekwencji. Etykietowanie to stanowi zmienną docelową (Y) dla modelu klasyfikacyjnego. Wykorzystano w tym celu usługi NCBI Entrez Utilities (Entrez efetch i elink), aby dla każdego numeru dostępu (Accession Number) uzyskać formalny Taxonomy ID. Następnie, na podstawie Tax ID, pobrano pełną ścieżkę taksonomiczną (Lineage) w celu pewnego mapowania każdej sekwencji do jednej z ośmiu predefiniowanych klas taksonomicznych. Proces ten zakończył się wygenerowaniem ujednoliconego pliku z numerycznymi identyfikatorami klas (Label_ID), co jest niezbędne do treningu modelu.

2. Reprezentacja Sekwencji: Chaos Game Representation (CGR)
Zgodnie z założeniami projektu, sekwencje DNA zostały przetworzone na dwuwymiarowe reprezentacje graficzne przy użyciu algorytmu Chaos Game Representation (CGR). Metoda ta, choć rzadko spotykana w tradycyjnej analizie filogenetycznej, efektywnie przekształca strukturę sekwencji nukleotydowej w obraz fraktalny. Obrazy CGR stanowią wejście (X) do modelu, pozwalając na wykorzystanie wysoce efektywnych architektur Konwolucyjnych Sieci Neuronowych (CNN) w celu identyfikacji wzorców filogenetycznych.

3. Wstępna Analiza i Przygotowanie Danych
Przed przejściem do modelowania wykonano analizę rozkładu klas w zbiorze danych w celu identyfikacji potencjalnych problemów z niezbalansowaniem. Następnie, przeprowadzono krytyczny podział danych na trzy zbiory: treningowy, walidacyjny i testowy. Aby zapewnić miarodajność oceny, zastosowano stratifikację, która gwarantuje, że proporcje klas taksonomicznych są zachowane w każdym z podzbiorów. Wstępne przetwarzanie obrazów CGR objęło:
    Ujednolicenie rozmiaru (np. do 128×128 pikseli).
    Normalizację wartości pikseli do zakresu [0,1].
    Zmianę kształtu do formatu akceptowanego przez CNN ((wysokość, szerokość, 1)).





Opis Metodologii Generowania Syntetycznych Wariantów Mitochondrialnego DNA

Przedmiotem niniejszego opracowania było wytworzenie syntetycznego zbioru danych wariantowych mitochondrialnego DNA (mtDNA), charakteryzującego się biologicznie realistycznym zróżnicowaniem częstości mutacji w zależności od funkcjonalnego regionu genomu. Proces ten został podzielony na dwa główne etapy: pozyskanie referencyjnych danych genetycznych oraz zaawansowaną symulację mutacyjną.

Procedura Pozyskania i Przygotowania Danych Referencyjnych

Dane referencyjne, w tym kompletne sekwencje mtDNA oraz ich szczegółowe adnotacje funkcjonalne, zostały pozyskane z bazy danych NCBI Nucleotide (GenBank). Proces ten został zautomatyzowany przy użyciu narzędzi E-utilities. Lista genomów do pobrania, określona przez ich numery dostępowe, została dostarczona w pliku tekstowym accessions.txt. Pobieranie sekwencji genomowych w formacie FASTA zrealizowano poprzez żądania HTTP do funkcji efetch.fcgi z ustawieniem parametrów db=nuccore i rettype=fasta. Kluczowym elementem zapewniającym stabilność i zgodność z polityką serwera NCBI była implementacja kontroli szybkości zapytań, polegająca na wprowadzeniu minimalnej pauzy czasowej (time.sleep(0.34)) po każdej operacji oraz zastosowanie mechanizmu ponawiania prób pobierania (retry logic) z wykładniczym narastaniem czasu oczekiwania (exponential backoff) w przypadku wystąpienia błędów serwera (np. kody 429, 503). W rezultacie, każda sekwencja referencyjna została zapisana jako odrębny plik w folderze fasta, z zachowaniem pełnego identyfikatora dostępowego wraz z numerem wersji (np. NC_xxxxxx.1.fasta). Równolegle, dla każdego genomu referencyjnego pozyskano pliki adnotacji funkcjonalnych w formacie GFF3, ustawiając parametr rettype=gff3 w analogicznym zapytaniu do E-utilities. Ze względu na fakt, że usługa NCBI często udostępnia adnotacje pod głównym, bezwersyjnym identyfikatorem (np. NC_005089), pliki GFF zostały zapisane pod nazwami pozbawionymi numeru wersji (np. NC_005089.gff3) w dedykowanym folderze GFF. W fazie przygotowawczej do symulacji mutacyjnej zaimplementowano mechanizm normalizacji i sparowania danych, który odczytywał pełny identyfikator pliku FASTA (NC_xxxxxx.1) i używał jego głównej części (NC_xxxxxx) do odnalezienia i wczytania odpowiadającego mu pliku adnotacji GFF.

Metodyka Modelowania i Symulacji Zmienności Genomowej

Generowanie syntetycznych wariantów mtDNA oparto na stochastycznej symulacji substytucji pojedynczych nukleotydów (SNV), której prawdopodobieństwo zostało zróżnicowane w oparciu o funkcjonalny kontekst danego regionu genomu. Zgodnie z założeniami, dla każdego genomu referencyjnego wygenerowano dziesięć (10) unikalnych wariantów. Proces generowania wariantów rozpoczął się od parsowania adnotacji GFF za pomocą biblioteki pandas, mapując kluczowe regiony funkcjonalne, takie jak geny kodujące białka, rRNA, tRNA, Region Kontrolny (D-loop) oraz regiony nieadnotowane, wraz z ich współrzędnymi i kierunkiem (nicie) odczytu.

Modelowanie prawdopodobieństwa mutacji uwzględniło znane nierówności zmienności w mitochondrialnym DNA. Najwyższą częstość mutacji zastosowano w Regionie Kontrolnym/D-loop ($P_{CR} = 0.005$ na pozycję), co odzwierciedla brak presji selekcyjnej w tym regionie. Natomiast najniższe prawdopodobieństwo mutacji, wynoszące zaledwie $P_{tRNA/rRNA} = 0.00005$ na pozycję, przypisano genom t/rRNA, co jest zgodne z silną presją selekcyjną na utrzymanie ich kluczowej struktury drugorzędowej. W regionach genów kodujących białka zastosowano bardziej złożoną dyskryminację: mutacje synonimiczne, które zachowują sekwencję aminokwasową, modelowano z prawdopodobieństwem $P_{SYN} = 0.001$ na kodon, natomiast mutacje niesynonimiczne, prowadzące do zmiany aminokwasu, symulowano z istotnie niższym prawdopodobieństwem $P_{NONSYN} = 0.0001$ na kodon, co jest odzwierciedleniem silnej selekcji negatywnej. W przypadku regionów nieadnotowanych zastosowano umiarkowaną częstość $P_{OTHER} = 0.0005$.

Ponadto, w symulacji SNV wprowadzono współczynnik biasu faworyzujący przejścia (A $\leftrightarrow$ G, C $\leftrightarrow$ T) z prawdopodobieństwem $P_{TRANSITION} = 0.8$, podczas gdy transwersje (np. A $\leftrightarrow$ C/T) zachodziły z pozostałym prawdopodobieństwem $P_{TRANSVERSION} = 0.2$. W celu precyzyjnego modelowania mutacji w genach, zastosowano mitochondrialny kod genetyczny kręgowców (NCBI ID 2). W przypadku mutacji synonimicznych, nowy kodon był losowany spośród tych, które kodują ten sam aminokwas, z preferencją dla zmian wynikających z pojedynczej substytucji nukleotydowej (1-SNV). Specjalną uwagę poświęcono obsłudze genów zlokalizowanych na nici minusowej (strand='-'), dla których mutacja była oceniana poprzez komplementację i odwrócenie kodonu przed i po zmianie, aby zapewnić, że mutacja synonimiczna jest poprawnie wprowadzana do ramki odczytu. Każdy z dziesięciu wygenerowanych wariantów dla danego genomu referencyjnego został finalnie zapisany jako niezależny plik FASTA w folderze ZMUTOWANE_SEKWENCJE, używając formatu nazewnictwa identyfikującego wariant, np. NC_xxxxxx.1_VAR1.fasta, co zapewnia pełną identyfikowalność i modularność w dalszych analizach.
